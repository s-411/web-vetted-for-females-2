<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Red Flags - Vetted</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet"/>
    <!-- Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ============================================
         DESIGN TOKENS
         ============================================
         All design decisions are tokenized here.
         Change a value once, update everywhere.
    -->
    <style>
        :root {
            /* ==========================================
               COLOR TOKENS
               ========================================== */

            /* Primary Brand Colors */
            --color-primary: #7f13ec;
            --color-primary-hover: #6b0fcc;
            --color-primary-dark: #4c0b8f;
            --color-primary-light: #a855f7;

            /* Secondary / Accent Colors */
            --color-accent: #d4af37;          /* Gold */
            --color-accent-light: #f3e5ab;    /* Light Gold */
            --color-accent-hover: #c9a227;

            /* Neutral / Base Colors */
            --color-plum: #2a173b;
            --color-plum-light: #4a2c63;
            --color-plum-muted: rgba(42, 23, 59, 0.6);

            /* Background Colors */
            --color-bg-primary: #f7f4ed;      /* Warm Tan */
            --color-bg-secondary: #ffffff;
            --color-bg-tertiary: #f8f7f4;
            --color-bg-sidebar: var(--color-plum);
            --color-bg-card: var(--color-bg-secondary);

            /* Text Colors */
            --color-text-primary: var(--color-plum);
            --color-text-secondary: rgba(42, 23, 59, 0.6);
            --color-text-tertiary: rgba(42, 23, 59, 0.4);
            --color-text-inverse: #ffffff;
            --color-text-inverse-muted: rgba(255, 255, 255, 0.7);

            /* Border Colors */
            --color-border: rgba(42, 23, 59, 0.05);
            --color-border-hover: rgba(42, 23, 59, 0.15);
            --color-border-accent: rgba(212, 175, 55, 0.3);

            /* Status Colors */
            --color-success: #16a34a;
            --color-success-bg: #f0fdf4;
            --color-warning: #ca8a04;
            --color-warning-bg: #fefce8;
            --color-error: #dc2626;
            --color-error-bg: #fef2f2;
            --color-info: #2563eb;
            --color-info-bg: #eff6ff;

            /* Category Colors */
            --color-water: #3b82f6;
            --color-water-bg: #eff6ff;
            --color-sleep: var(--color-primary);
            --color-sleep-bg: #faf5ff;
            --color-mood: #eab308;
            --color-mood-bg: #fefce8;
            --color-energy: #ec4899;
            --color-energy-bg: #fdf2f8;
            --color-social: #f59e0b;
            --color-social-bg: #fffbeb;

            /* Event Colors */
            --color-event-primary: var(--color-primary);
            --color-event-secondary: #14b8a6;
            --color-event-tertiary: #d1d5db;
        }

        /* ==========================================
           DARK MODE COLORS
           ========================================== */
        html.dark {
            /* Primary Brand Colors - slightly brighter for dark bg */
            --color-primary: #9333ea;
            --color-primary-hover: #a855f7;
            --color-primary-dark: #7c3aed;
            --color-primary-light: #c084fc;

            /* Accent stays warm gold */
            --color-accent: #d4af37;
            --color-accent-light: #b8942e;
            --color-accent-hover: #e5c158;

            /* Dark neutrals */
            --color-plum: #f8f7f4;
            --color-plum-light: #e5e4e1;
            --color-plum-muted: rgba(248, 247, 244, 0.6);

            /* Background Colors - deep plum/purple tones */
            --color-bg-primary: #1a1625;
            --color-bg-secondary: #241e30;
            --color-bg-tertiary: #2d2640;
            --color-bg-sidebar: #13101a;
            --color-bg-card: #241e30;

            /* Text Colors - light on dark */
            --color-text-primary: #f8f7f4;
            --color-text-secondary: rgba(248, 247, 244, 0.7);
            --color-text-tertiary: rgba(248, 247, 244, 0.5);
            /* text-inverse stays white - used on dark sidebar */
            --color-text-inverse: #ffffff;
            --color-text-inverse-muted: rgba(255, 255, 255, 0.7);

            /* Border Colors */
            --color-border: rgba(255, 255, 255, 0.08);
            --color-border-hover: rgba(255, 255, 255, 0.15);
            --color-border-accent: rgba(212, 175, 55, 0.4);

            /* Status Colors - adjusted for dark bg */
            --color-success: #22c55e;
            --color-success-bg: rgba(34, 197, 94, 0.15);
            --color-warning: #eab308;
            --color-warning-bg: rgba(234, 179, 8, 0.15);
            --color-error: #ef4444;
            --color-error-bg: rgba(239, 68, 68, 0.15);
            --color-info: #3b82f6;
            --color-info-bg: rgba(59, 130, 246, 0.15);

            /* Category Colors - adjusted for dark bg */
            --color-water: #60a5fa;
            --color-water-bg: rgba(96, 165, 250, 0.15);
            --color-sleep-bg: rgba(147, 51, 234, 0.15);
            --color-mood: #facc15;
            --color-mood-bg: rgba(250, 204, 21, 0.15);
            --color-energy: #f472b6;
            --color-energy-bg: rgba(244, 114, 182, 0.15);
            --color-social: #fbbf24;
            --color-social-bg: rgba(251, 191, 36, 0.15);

            /* Scrollbar for dark mode */
            color-scheme: dark;
        }

        /* ==========================================
           TYPOGRAPHY TOKENS (in :root)
           ========================================== */
        :root {
            /* Font Families */
            --font-display: 'Manrope', system-ui, sans-serif;
            --font-serif: 'Playfair Display', Georgia, serif;

            /* Font Sizes */
            --text-xs: 0.75rem;      /* 12px */
            --text-sm: 0.875rem;     /* 14px */
            --text-base: 1rem;       /* 16px */
            --text-lg: 1.125rem;     /* 18px */
            --text-xl: 1.25rem;      /* 20px */
            --text-2xl: 1.5rem;      /* 24px */
            --text-3xl: 1.875rem;    /* 30px */
            --text-4xl: 2.25rem;     /* 36px */
            --text-5xl: 3rem;        /* 48px */

            /* Font Weights */
            --font-normal: 400;
            --font-medium: 500;
            --font-semibold: 600;
            --font-bold: 700;

            /* Line Heights */
            --leading-tight: 1.25;
            --leading-normal: 1.5;
            --leading-relaxed: 1.625;

            /* Letter Spacing */
            --tracking-tight: -0.025em;
            --tracking-normal: 0;
            --tracking-wide: 0.025em;
            --tracking-wider: 0.05em;
            --tracking-widest: 0.1em;

            /* ==========================================
               SPACING TOKENS
               ========================================== */

            --space-0: 0;
            --space-1: 0.25rem;      /* 4px */
            --space-2: 0.5rem;       /* 8px */
            --space-3: 0.75rem;      /* 12px */
            --space-4: 1rem;         /* 16px */
            --space-5: 1.25rem;      /* 20px */
            --space-6: 1.5rem;       /* 24px */
            --space-8: 2rem;         /* 32px */
            --space-10: 2.5rem;      /* 40px */
            --space-12: 3rem;        /* 48px */
            --space-16: 4rem;        /* 64px */

            /* ==========================================
               BORDER RADIUS TOKENS
               ========================================== */

            --radius-none: 0;
            --radius-sm: 0.25rem;    /* 4px */
            --radius-md: 0.5rem;     /* 8px */
            --radius-lg: 0.75rem;    /* 12px */
            --radius-xl: 1rem;       /* 16px */
            --radius-2xl: 1.5rem;    /* 24px */
            --radius-full: 9999px;

            /* ==========================================
               SHADOW TOKENS
               ========================================== */

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
            --shadow-card: 0 2px 15px -3px rgba(0, 0, 0, 0.07);

            /* ==========================================
               TRANSITION TOKENS
               ========================================== */

            --transition-fast: 150ms ease;
            --transition-base: 200ms ease;
            --transition-slow: 300ms ease;
            --transition-slower: 500ms ease;

            /* ==========================================
               SIZE TOKENS
               ========================================== */

            /* Sidebar */
            --sidebar-width: 16rem;  /* 256px */
            --sidebar-collapsed-width: 4.5rem;  /* 72px */

            /* Header */
            --header-height: 4rem;   /* 64px */

            /* Avatar Sizes */
            --avatar-sm: 1.5rem;     /* 24px */
            --avatar-md: 2.5rem;     /* 40px */
            --avatar-lg: 3.5rem;     /* 56px */

            /* Icon Sizes */
            --icon-sm: 1rem;         /* 16px */
            --icon-md: 1.5rem;       /* 24px */
            --icon-lg: 2rem;         /* 32px */

            /* Button Heights */
            --btn-height-sm: 2rem;
            --btn-height-md: 2.5rem;
            --btn-height-lg: 3rem;

            /* Stat Icon Size */
            --stat-icon-size: 3rem;  /* 48px */

            /* ==========================================
               Z-INDEX TOKENS
               ========================================== */

            --z-base: 0;
            --z-dropdown: 10;
            --z-sticky: 20;
            --z-header: 30;
            --z-overlay: 40;
            --z-modal: 50;
            --z-toast: 60;
        }

        /* ==========================================
           MATERIAL ICONS CONFIGURATION
           ========================================== */
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .icon-filled {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* ==========================================
           CUSTOM SCROLLBAR
           ========================================== */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-accent);
            border-radius: var(--radius-full);
        }

        /* Sidebar Collapse Transitions */
        .sidebar-transition {
            transition: width 300ms ease, padding 300ms ease;
        }
        .sidebar-collapsed .sidebar-label {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }
        .sidebar-expanded .sidebar-label {
            opacity: 1;
            width: auto;
            transition: opacity 200ms ease 100ms;
        }
        .sidebar-collapsed .sidebar-hideable {
            display: none;
        }
        .sidebar-collapsed .sidebar-collapse-icon {
            transform: rotate(180deg);
        }
        /* Collapsed state - center icons */
        .sidebar-collapsed .sidebar-logo {
            justify-content: center;
            padding-left: 0;
            padding-right: 0;
        }
        .sidebar-collapsed .sidebar-nav {
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }
        .sidebar-collapsed .sidebar-nav-item {
            justify-content: center;
            padding-left: 0;
            padding-right: 0;
            gap: 0;
        }
        .sidebar-collapsed .sidebar-bottom {
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }
        .sidebar-collapsed .sidebar-profile {
            justify-content: center;
        }
        .sidebar-collapsed .sidebar-collapse-btn {
            justify-content: center;
            gap: 0;
        }
        .sidebar-collapsed .sidebar-collapsed-show {
            display: flex !important;
        }
        .theme-btn-active {
            background: rgba(255, 255, 255, 0.2);
        }
        .theme-btn-active span {
            color: var(--color-accent) !important;
        }

        /* Modal backdrop */
        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        /* Custom checkbox styles for warning theme */
        .checkbox-warning {
            accent-color: var(--color-warning);
        }
        .checkbox-warning:checked {
            background-color: var(--color-warning);
            border-color: var(--color-warning);
        }
    </style>

    <!-- Tailwind Config Using Design Tokens -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Primary
                        'primary': 'var(--color-primary)',
                        'primary-hover': 'var(--color-primary-hover)',
                        'primary-dark': 'var(--color-primary-dark)',
                        'primary-light': 'var(--color-primary-light)',

                        // Accent
                        'accent': 'var(--color-accent)',
                        'accent-light': 'var(--color-accent-light)',
                        'accent-hover': 'var(--color-accent-hover)',

                        // Neutrals
                        'plum': 'var(--color-plum)',
                        'plum-light': 'var(--color-plum-light)',
                        'plum-muted': 'var(--color-plum-muted)',

                        // Backgrounds
                        'bg-primary': 'var(--color-bg-primary)',
                        'bg-secondary': 'var(--color-bg-secondary)',
                        'bg-tertiary': 'var(--color-bg-tertiary)',
                        'bg-sidebar': 'var(--color-bg-sidebar)',
                        'bg-card': 'var(--color-bg-card)',

                        // Text
                        'text-primary': 'var(--color-text-primary)',
                        'text-secondary': 'var(--color-text-secondary)',
                        'text-tertiary': 'var(--color-text-tertiary)',
                        'text-inverse': 'var(--color-text-inverse)',
                        'text-inverse-muted': 'var(--color-text-inverse-muted)',

                        // Borders
                        'border-default': 'var(--color-border)',
                        'border-hover': 'var(--color-border-hover)',
                        'border-accent': 'var(--color-border-accent)',

                        // Status
                        'success': 'var(--color-success)',
                        'success-bg': 'var(--color-success-bg)',
                        'warning': 'var(--color-warning)',
                        'warning-bg': 'var(--color-warning-bg)',
                        'error': 'var(--color-error)',
                        'error-bg': 'var(--color-error-bg)',
                        'info': 'var(--color-info)',
                        'info-bg': 'var(--color-info-bg)',

                        // Categories
                        'water': 'var(--color-water)',
                        'water-bg': 'var(--color-water-bg)',
                        'sleep': 'var(--color-sleep)',
                        'sleep-bg': 'var(--color-sleep-bg)',
                        'mood': 'var(--color-mood)',
                        'mood-bg': 'var(--color-mood-bg)',
                        'energy': 'var(--color-energy)',
                        'energy-bg': 'var(--color-energy-bg)',
                        'social': 'var(--color-social)',
                        'social-bg': 'var(--color-social-bg)',

                        // Events
                        'event-primary': 'var(--color-event-primary)',
                        'event-secondary': 'var(--color-event-secondary)',
                        'event-tertiary': 'var(--color-event-tertiary)',
                    },
                    fontFamily: {
                        'display': 'var(--font-display)',
                        'serif': 'var(--font-serif)',
                    },
                    fontSize: {
                        'xs': 'var(--text-xs)',
                        'sm': 'var(--text-sm)',
                        'base': 'var(--text-base)',
                        'lg': 'var(--text-lg)',
                        'xl': 'var(--text-xl)',
                        '2xl': 'var(--text-2xl)',
                        '3xl': 'var(--text-3xl)',
                        '4xl': 'var(--text-4xl)',
                        '5xl': 'var(--text-5xl)',
                    },
                    fontWeight: {
                        'normal': 'var(--font-normal)',
                        'medium': 'var(--font-medium)',
                        'semibold': 'var(--font-semibold)',
                        'bold': 'var(--font-bold)',
                    },
                    lineHeight: {
                        'tight': 'var(--leading-tight)',
                        'normal': 'var(--leading-normal)',
                        'relaxed': 'var(--leading-relaxed)',
                    },
                    letterSpacing: {
                        'tight': 'var(--tracking-tight)',
                        'normal': 'var(--tracking-normal)',
                        'wide': 'var(--tracking-wide)',
                        'wider': 'var(--tracking-wider)',
                        'widest': 'var(--tracking-widest)',
                    },
                    spacing: {
                        '0': 'var(--space-0)',
                        '1': 'var(--space-1)',
                        '2': 'var(--space-2)',
                        '3': 'var(--space-3)',
                        '4': 'var(--space-4)',
                        '5': 'var(--space-5)',
                        '6': 'var(--space-6)',
                        '8': 'var(--space-8)',
                        '10': 'var(--space-10)',
                        '12': 'var(--space-12)',
                        '16': 'var(--space-16)',
                        'sidebar': 'var(--sidebar-width)',
                        'header': 'var(--header-height)',
                    },
                    borderRadius: {
                        'none': 'var(--radius-none)',
                        'sm': 'var(--radius-sm)',
                        'DEFAULT': 'var(--radius-md)',
                        'md': 'var(--radius-md)',
                        'lg': 'var(--radius-lg)',
                        'xl': 'var(--radius-xl)',
                        '2xl': 'var(--radius-2xl)',
                        'full': 'var(--radius-full)',
                    },
                    boxShadow: {
                        'sm': 'var(--shadow-sm)',
                        'DEFAULT': 'var(--shadow-md)',
                        'md': 'var(--shadow-md)',
                        'lg': 'var(--shadow-lg)',
                        'xl': 'var(--shadow-xl)',
                        'card': 'var(--shadow-card)',
                    },
                    transitionDuration: {
                        'fast': '150ms',
                        'DEFAULT': '200ms',
                        'slow': '300ms',
                        'slower': '500ms',
                    },
                    width: {
                        'sidebar': 'var(--sidebar-width)',
                        'sidebar-collapsed': 'var(--sidebar-collapsed-width)',
                        'avatar-sm': 'var(--avatar-sm)',
                        'avatar-md': 'var(--avatar-md)',
                        'avatar-lg': 'var(--avatar-lg)',
                        'stat-icon': 'var(--stat-icon-size)',
                    },
                    height: {
                        'header': 'var(--header-height)',
                        'avatar-sm': 'var(--avatar-sm)',
                        'avatar-md': 'var(--avatar-md)',
                        'avatar-lg': 'var(--avatar-lg)',
                        'stat-icon': 'var(--stat-icon-size)',
                        'btn-sm': 'var(--btn-height-sm)',
                        'btn-md': 'var(--btn-height-md)',
                        'btn-lg': 'var(--btn-height-lg)',
                    },
                    zIndex: {
                        'base': 'var(--z-base)',
                        'dropdown': 'var(--z-dropdown)',
                        'sticky': 'var(--z-sticky)',
                        'header': 'var(--z-header)',
                        'overlay': 'var(--z-overlay)',
                        'modal': 'var(--z-modal)',
                        'toast': 'var(--z-toast)',
                    },
                },
            },
        }
    </script>
</head>
<body class="bg-bg-primary text-text-primary font-display antialiased overflow-hidden">
    <div class="flex h-screen w-full">
        <!-- Sidebar -->
        <aside id="sidebar" class="hidden lg:flex flex-col w-sidebar bg-bg-sidebar text-text-inverse h-full shrink-0 sidebar-transition sidebar-expanded">
            <!-- Logo (Clickable to toggle) -->
            <div class="sidebar-logo p-6 pb-4 cursor-pointer hover:bg-white/5 transition-colors duration-200 flex items-center gap-3" onclick="toggleSidebar()">
                <span class="material-symbols-outlined text-accent text-3xl shrink-0">verified_user</span>
                <div class="sidebar-label sidebar-hideable">
                    <h1 class="font-serif text-2xl font-bold text-text-inverse">Vetted</h1>
                    <p class="text-text-inverse-muted text-sm mt-1">Know Your Worth</p>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="sidebar-nav flex-1 px-4 py-6 flex flex-col gap-1">
                <a class="sidebar-nav-item flex items-center gap-4 px-4 py-3 rounded-lg text-text-inverse-muted hover:bg-white/5 hover:text-text-inverse transition-all duration-200" href="index.html" title="Profiles">
                    <span class="material-symbols-outlined shrink-0">dashboard</span>
                    <span class="font-medium sidebar-label">Profiles</span>
                </a>
                <a class="sidebar-nav-item flex items-center gap-4 px-4 py-3 rounded-lg text-text-inverse-muted hover:bg-white/5 hover:text-text-inverse transition-all duration-200" href="archives.html" title="Archives">
                    <span class="material-symbols-outlined shrink-0">inventory_2</span>
                    <span class="font-medium sidebar-label">Archives</span>
                </a>
                <a class="sidebar-nav-item flex items-center gap-4 px-4 py-3 rounded-lg text-text-inverse-muted hover:bg-white/5 hover:text-text-inverse transition-all duration-200" href="settings.html" title="Settings">
                    <span class="material-symbols-outlined shrink-0">settings</span>
                    <span class="font-medium sidebar-label">Settings</span>
                </a>

                <!-- Divider -->
                <div class="my-4 border-t border-white/10"></div>

                <a class="sidebar-nav-item flex items-center gap-4 px-4 py-3 rounded-lg text-text-inverse-muted hover:bg-white/5 hover:text-text-inverse transition-all duration-200" href="landing.html" title="Landing Page">
                    <span class="material-symbols-outlined shrink-0">home</span>
                    <span class="font-medium sidebar-label">Landing Page</span>
                </a>
            </nav>

            <!-- Bottom Section -->
            <div class="sidebar-bottom p-4 border-t border-white/10">
                <!-- Theme & Collapse Row -->
                <div class="flex items-center justify-between mb-4 sidebar-hideable">
                    <div class="flex items-center gap-1 bg-white/10 rounded-lg p-1">
                        <button onclick="setTheme('light')" id="theme-light" class="w-10 h-10 flex items-center justify-center rounded-md hover:bg-white/10 transition-colors duration-200" title="Light mode">
                            <span class="material-symbols-outlined text-xl text-text-inverse-muted">light_mode</span>
                        </button>
                        <button onclick="setTheme('dark')" id="theme-dark" class="w-10 h-10 flex items-center justify-center rounded-md hover:bg-white/10 transition-colors duration-200" title="Dark mode">
                            <span class="material-symbols-outlined text-xl text-text-inverse-muted">dark_mode</span>
                        </button>
                    </div>
                    <button onclick="toggleSidebar()" class="p-2 rounded-lg hover:bg-white/10 transition-colors duration-200" title="Collapse sidebar">
                        <span class="material-symbols-outlined sidebar-collapse-icon transition-transform duration-300 text-text-inverse-muted hover:text-text-inverse">keyboard_double_arrow_left</span>
                    </button>
                </div>

                <!-- Collapsed state: just collapse icon -->
                <button onclick="toggleSidebar()" class="sidebar-collapse-btn hidden sidebar-collapsed-show w-full flex items-center justify-center py-2 rounded-lg hover:bg-white/10 transition-all duration-200 text-text-inverse-muted hover:text-text-inverse mb-4" title="Expand sidebar">
                    <span class="material-symbols-outlined sidebar-collapse-icon transition-transform duration-300 shrink-0">keyboard_double_arrow_left</span>
                </button>

                <!-- Privacy Note -->
                <div class="sidebar-hideable text-center">
                    <p class="text-xs text-text-inverse-muted flex items-center justify-center gap-1">
                        <span class="material-symbols-outlined text-sm">lock</span>
                        Data stored locally
                    </p>
                </div>
            </div>
        </aside>

        <!-- Sidebar Toggle Script -->
        <script>
            function toggleSidebar() {
                const sidebar = document.getElementById('sidebar');
                const isExpanded = sidebar.classList.contains('sidebar-expanded');

                if (isExpanded) {
                    sidebar.classList.remove('sidebar-expanded', 'w-sidebar');
                    sidebar.classList.add('sidebar-collapsed', 'w-sidebar-collapsed');
                } else {
                    sidebar.classList.remove('sidebar-collapsed', 'w-sidebar-collapsed');
                    sidebar.classList.add('sidebar-expanded', 'w-sidebar');
                }
            }

            // Theme Management
            function setTheme(theme) {
                const html = document.documentElement;

                if (theme === 'dark') {
                    html.classList.remove('light');
                    html.classList.add('dark');
                } else if (theme === 'light') {
                    html.classList.remove('dark');
                    html.classList.add('light');
                } else {
                    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                    html.classList.remove('light', 'dark');
                    html.classList.add(prefersDark ? 'dark' : 'light');
                }

                localStorage.setItem('theme', theme);
                updateSidebarThemeButtons(theme);
            }

            function updateSidebarThemeButtons(theme) {
                const lightBtn = document.getElementById('theme-light');
                const darkBtn = document.getElementById('theme-dark');
                if (lightBtn && darkBtn) {
                    lightBtn.classList.remove('theme-btn-active');
                    darkBtn.classList.remove('theme-btn-active');
                    if (theme === 'light') lightBtn.classList.add('theme-btn-active');
                    if (theme === 'dark') darkBtn.classList.add('theme-btn-active');
                }
            }

            // Initialize theme on page load
            (function() {
                const savedTheme = localStorage.getItem('theme') || 'light';
                setTheme(savedTheme);

                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    if (localStorage.getItem('theme') === 'system') {
                        setTheme('system');
                    }
                });
            })();
        </script>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col h-full overflow-hidden">
            <!-- Scrollable Content -->
            <div class="flex-1 overflow-y-auto p-8">
                <div class="max-w-3xl mx-auto">
                    <!-- Back Button -->
                    <a id="back-link" href="profile.html" class="inline-flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors mb-6">
                        <span class="material-symbols-outlined text-lg">arrow_back</span>
                        <span class="text-sm font-medium">Back to Profile</span>
                    </a>

                    <!-- Header Section -->
                    <div class="bg-bg-card rounded-2xl border border-border-default shadow-card p-6 mb-6">
                        <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                            <div>
                                <div class="flex items-center gap-3 mb-2">
                                    <span class="material-symbols-outlined text-warning text-2xl">flag</span>
                                    <h1 class="font-serif text-3xl font-bold text-text-primary">Red Flags</h1>
                                </div>
                                <p id="profile-subtitle" class="text-text-secondary">Loading...</p>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="text-right">
                                    <p id="progress-count" class="text-lg font-bold text-text-primary">0 of 23</p>
                                    <p class="text-xs text-text-tertiary">flags selected</p>
                                </div>
                                <span id="grade-badge" class="px-4 py-2 rounded-full text-lg font-bold bg-warning-bg text-warning">
                                    C
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Red Flags Checklist -->
                    <div class="bg-bg-card rounded-2xl border border-border-default shadow-card overflow-hidden">
                        <div class="p-4 border-b border-border-default bg-warning-bg/50">
                            <div class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-warning">warning</span>
                                <p class="text-sm font-medium text-text-primary">Warning signs to watch for</p>
                            </div>
                        </div>
                        <div id="flags-list" class="divide-y divide-border-default">
                            <!-- Flags will be rendered here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Red Flags Page JavaScript -->
    <script type="module">
        import { Store } from './src/js/store.js';
        import { getGradeColor } from './src/js/grading.js';
        import { getProfileIdFromUrl, escapeHtml } from './src/js/utils.js';
        import { redFlags } from './src/data/red-flags.js';

        let currentProfile = null;

        function updateGradeBadge() {
            const badge = document.getElementById('grade-badge');
            if (!currentProfile) return;

            const colors = getGradeColor(currentProfile.grade);
            badge.className = `px-4 py-2 rounded-full text-lg font-bold ${colors.bg} ${colors.text}`;
            badge.textContent = currentProfile.grade;
        }

        function updateProgress() {
            const progressEl = document.getElementById('progress-count');
            if (!currentProfile) return;

            const count = currentProfile.redFlags.length;
            progressEl.textContent = `${count} of ${redFlags.length}`;
        }

        function handleFlagChange(flagId, isChecked) {
            const profileId = getProfileIdFromUrl();
            currentProfile = Store.toggleFlag(profileId, 'redFlags', flagId, isChecked);
            updateGradeBadge();
            updateProgress();
        }

        function renderFlagItem(flag, isChecked) {
            return `
                <label class="flex items-center gap-4 p-4 hover:bg-warning-bg/30 cursor-pointer transition-colors duration-150">
                    <input
                        type="checkbox"
                        id="flag-${flag.id}"
                        class="w-5 h-5 rounded border-2 border-warning text-warning focus:ring-warning focus:ring-offset-0 checkbox-warning cursor-pointer"
                        ${isChecked ? 'checked' : ''}
                        onchange="window.handleFlagChange('${flag.id}', this.checked)"
                    />
                    <span class="material-symbols-outlined text-warning text-xl shrink-0">${flag.icon || 'flag'}</span>
                    <span class="text-text-primary flex-1">${escapeHtml(flag.label)}</span>
                </label>
            `;
        }

        function renderFlags() {
            const listEl = document.getElementById('flags-list');
            if (!currentProfile) return;

            const checkedFlags = new Set(currentProfile.redFlags);
            listEl.innerHTML = redFlags.map(flag =>
                renderFlagItem(flag, checkedFlags.has(flag.id))
            ).join('');
        }

        function initPage() {
            const profileId = getProfileIdFromUrl();

            if (!profileId) {
                window.location.href = 'index.html';
                return;
            }

            currentProfile = Store.getProfile(profileId);

            if (!currentProfile) {
                window.location.href = 'index.html';
                return;
            }

            // Update back link
            const backLink = document.getElementById('back-link');
            backLink.href = `profile.html?id=${profileId}`;

            // Update subtitle with profile name
            const subtitle = document.getElementById('profile-subtitle');
            subtitle.textContent = `Evaluating ${escapeHtml(currentProfile.name)}`;

            // Initial render
            renderFlags();
            updateGradeBadge();
            updateProgress();
        }

        // Make handler available globally
        window.handleFlagChange = handleFlagChange;

        // Initialize on page load
        initPage();
    </script>
</body>
</html>
